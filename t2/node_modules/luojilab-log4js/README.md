# v1.x usage

### Features
-  重写perfix方法，现在作为索引输出，不再添加到log中
-  修复不能写入日志文件的bug
  - 初始化文件 {package.json中的name}
  - 每日备份一次，格式为 {package.json中的name}.yyyy-MM-dd.log  

### step1
```javascript
// express app.js
const log = require('luojilab-log4js').use

const log = logger(app)

module.exports = log
```

### step2
```javascript
// router/*.js
const log = require('../../app') // 引根目录下的app.js export出来的log方法

log.info('step one','api detail info'); // replace console.log
log.warn('warn'); // send error type message to file
log.error('error'); // send error type message to file and sentry
log.prefix('key'); //add new key for every request

//compatible shzf-h5
log.loginfo('info') // not recommended for use
log.logerr('error') // not recommended for use
```

### demo

```javascript
log.info('1、获取的接口数据');
log.info('2、获取的接口数据', '详细信息内容JSON');
log.prefix("userid");
log.info('3、新日志带着用户信息');
log.info('4、redis');
```

```bash
[2017-05-05 16:03:33.509] [INFO] out - 19i1dnjt39dc3a5;1、获取的接口数据
[2017-05-05 16:03:33.514] [INFO] out - 19i1dnjt39dc3a5;2、获取的接口数据;4a0h099f1d9997a1493971413513
[2017-05-05 16:03:33.515] [INFO] out - 4a0h099f1d9997a1493971413513;详细信息内容JSON
[2017-05-05 16:03:33.515] [INFO] [userid] out - 19i1dnjt39dc3a5;3、新日志带着用户信息
[2017-05-05 16:03:33.515] [INFO] [userid] out - 19i1dnjt39dc3a5;4、redis
```

#### 阿里云日志收集平台

search `19i1dnjt39dc3a5`
```bash
19i1dnjt39dc3a5;1、获取的接口数据
19i1dnjt39dc3a5;2、获取的接口数据;4a0h099f1d9997a1493971413513
19i1dnjt39dc3a5;3、新日志带着用户信息
19i1dnjt39dc3a5;4、redis
```

serch `userid`
```bash
[2017-05-05 16:03:33.515] [INFO] [userid] out - 19i1dnjt39dc3a5;3、新日志带着用户信息
[2017-05-05 16:03:33.515] [INFO] [userid] out - 19i1dnjt39dc3a5;4、redis
```


search `4a0h099f1d9997a1493971413513`
```bash
4a0h099f1d9997a1493971413513;详细信息内容JSON
```
